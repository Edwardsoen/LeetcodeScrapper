{"tags": [{"duration": "1 year - 2 years", "companies": [["1 year - 2 years", "Uber"]]}], "problem": "<p>Table: <code>Drivers</code></p>\n\n<pre>+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| driver_id   | int     |\n| join_date   | date    |\n+-------------+---------+\ndriver_id is the primary key for this table.\nEach row of this table contains the driver's ID and the date they joined the Hopper company.\n</pre>\n\n<p>&nbsp;</p>\n\n<p>Table: <code>Rides</code></p>\n\n<pre>+--------------+---------+\n| Column Name  | Type    |\n+--------------+---------+\n| ride_id      | int     |\n| user_id      | int     |\n| requested_at | date    |\n+--------------+---------+\nride_id is the primary key for this table.\nEach row of this table contains the ID of a ride, the user's ID that requested it, and the day they requested it.\nThere may be some ride requests in this table that were not accepted.\n</pre>\n\n<p>&nbsp;</p>\n\n<p>Table: <code>AcceptedRides</code></p>\n\n<pre>+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| ride_id       | int     |\n| driver_id     | int     |\n| ride_distance | int     |\n| ride_duration | int     |\n+---------------+---------+\nride_id is the primary key for this table.\nEach row of this table contains some information about an accepted ride.\nIt is guaranteed that each accepted ride exists in the Rides table.\n</pre>\n\n<p>&nbsp;</p>\n\n<p>Write an SQL query to report the <strong>percentage</strong> of working drivers (<code>working_percentage</code>) for each month of <strong>2020</strong> where:</p>\n<img alt=\"\" src=\"https://assets.leetcode.com/uploads/2020/10/31/codecogseqn.png\" style=\"width: 800px; height: 36px;\">\n<p><strong>Note</strong> that if the number of available drivers during a month is zero, we consider the <code>working_percentage</code> to be <code>0</code>.</p>\n\n<p>Return the result table ordered by <code>month</code> in <strong>ascending</strong> order, where <code>month</code> is the month's number (January is <code>1</code>, February is <code>2</code>, etc.). Round <code>working_percentage</code> to the nearest <strong>2 decimal places</strong>.</p>\n\n<p>The query result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre><strong>Input:</strong> \nDrivers table:\n+-----------+------------+\n| driver_id | join_date  |\n+-----------+------------+\n| 10        | 2019-12-10 |\n| 8         | 2020-1-13  |\n| 5         | 2020-2-16  |\n| 7         | 2020-3-8   |\n| 4         | 2020-5-17  |\n| 1         | 2020-10-24 |\n| 6         | 2021-1-5   |\n+-----------+------------+\nRides table:\n+---------+---------+--------------+\n| ride_id | user_id | requested_at |\n+---------+---------+--------------+\n| 6       | 75      | 2019-12-9    |\n| 1       | 54      | 2020-2-9     |\n| 10      | 63      | 2020-3-4     |\n| 19      | 39      | 2020-4-6     |\n| 3       | 41      | 2020-6-3     |\n| 13      | 52      | 2020-6-22    |\n| 7       | 69      | 2020-7-16    |\n| 17      | 70      | 2020-8-25    |\n| 20      | 81      | 2020-11-2    |\n| 5       | 57      | 2020-11-9    |\n| 2       | 42      | 2020-12-9    |\n| 11      | 68      | 2021-1-11    |\n| 15      | 32      | 2021-1-17    |\n| 12      | 11      | 2021-1-19    |\n| 14      | 18      | 2021-1-27    |\n+---------+---------+--------------+\nAcceptedRides table:\n+---------+-----------+---------------+---------------+\n| ride_id | driver_id | ride_distance | ride_duration |\n+---------+-----------+---------------+---------------+\n| 10      | 10        | 63            | 38            |\n| 13      | 10        | 73            | 96            |\n| 7       | 8         | 100           | 28            |\n| 17      | 7         | 119           | 68            |\n| 20      | 1         | 121           | 92            |\n| 5       | 7         | 42            | 101           |\n| 2       | 4         | 6             | 38            |\n| 11      | 8         | 37            | 43            |\n| 15      | 8         | 108           | 82            |\n| 12      | 8         | 38            | 34            |\n| 14      | 1         | 90            | 74            |\n+---------+-----------+---------------+---------------+\n<strong>Output:</strong> \n+-------+--------------------+\n| month | working_percentage |\n+-------+--------------------+\n| 1     | 0.00               |\n| 2     | 0.00               |\n| 3     | 25.00              |\n| 4     | 0.00               |\n| 5     | 0.00               |\n| 6     | 20.00              |\n| 7     | 20.00              |\n| 8     | 20.00              |\n| 9     | 0.00               |\n| 10    | 0.00               |\n| 11    | 33.33              |\n| 12    | 16.67              |\n+-------+--------------------+\n<strong>Explanation:</strong> \nBy the end of January --&gt; two active drivers (10, 8) and no accepted rides. The percentage is 0%.\nBy the end of February --&gt; three active drivers (10, 8, 5) and no accepted rides. The percentage is 0%.\nBy the end of March --&gt; four active drivers (10, 8, 5, 7) and one accepted ride by driver (10). The percentage is (1 / 4) * 100 = 25%.\nBy the end of April --&gt; four active drivers (10, 8, 5, 7) and no accepted rides. The percentage is 0%.\nBy the end of May --&gt; five active drivers (10, 8, 5, 7, 4) and no accepted rides. The percentage is 0%.\nBy the end of June --&gt; five active drivers (10, 8, 5, 7, 4) and one accepted ride by driver (10). The percentage is (1 / 5) * 100 = 20%.\nBy the end of July --&gt; five active drivers (10, 8, 5, 7, 4) and one accepted ride by driver (8). The percentage is (1 / 5) * 100 = 20%.\nBy the end of August --&gt; five active drivers (10, 8, 5, 7, 4) and one accepted ride by driver (7). The percentage is (1 / 5) * 100 = 20%.\nBy the end of September --&gt; five active drivers (10, 8, 5, 7, 4) and no accepted rides. The percentage is 0%.\nBy the end of October --&gt; six active drivers (10, 8, 5, 7, 4, 1) and no accepted rides. The percentage is 0%.\nBy the end of November --&gt; six active drivers (10, 8, 5, 7, 4, 1) and two accepted rides by <strong>two different</strong> drivers (1, 7). The percentage is (2 / 6) * 100 = 33.33%.\nBy the end of December --&gt; six active drivers (10, 8, 5, 7, 4, 1) and one accepted ride by driver (4). The percentage is (1 / 6) * 100 = 16.67%.\n</pre>\n", "relatedTopics": ["Database"], "similarQuestions": [], "problemName": "hopper-company-queries-ii"}