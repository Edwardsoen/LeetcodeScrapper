{"tags": [{"duration": "1 year - 2 years", "companies": [["1 year - 2 years", "Amazon\n2"]]}], "problem": "<p>Table: <code>Employee</code></p>\n\n<pre>+-------------+------+\n| Column Name | Type |\n+-------------+------+\n| id          | int  |\n| month       | int  |\n| salary      | int  |\n+-------------+------+\n(id, month) is the primary key for this table.\nEach row in the table indicates the salary of an employee in one month during the year 2020.\n</pre>\n\n<p>&nbsp;</p>\n\n<p>Write an SQL query to calculate the <strong>cumulative salary summary</strong> for every employee in a single unified table.</p>\n\n<p>The <strong>cumulative salary summary</strong> for an employee can be calculated as follows:</p>\n\n<ul>\n\t<li>For each month that the employee worked, <strong>sum</strong> up the salaries in <strong>that month</strong> and the <strong>previous two months</strong>. This is their <strong>3-month sum</strong> for that month. If an employee did not work for the company in previous months, their effective salary for those months is <code>0</code>.</li>\n\t<li>Do <strong>not</strong> include the 3-month sum for the <strong>most recent month</strong> that the employee worked for in the summary.</li>\n\t<li>Do <strong>not</strong> include the 3-month sum for any month the employee <strong>did not work</strong>.</li>\n</ul>\n\n<p>Return the result table ordered by <code>id</code> in <strong>ascending order</strong>. In case of a tie, order it by <code>month</code> in <strong>descending order</strong>.</p>\n\n<p>The query result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre><strong>Input:</strong> \nEmployee table:\n+----+-------+--------+\n| id | month | salary |\n+----+-------+--------+\n| 1  | 1     | 20     |\n| 2  | 1     | 20     |\n| 1  | 2     | 30     |\n| 2  | 2     | 30     |\n| 3  | 2     | 40     |\n| 1  | 3     | 40     |\n| 3  | 3     | 60     |\n| 1  | 4     | 60     |\n| 3  | 4     | 70     |\n| 1  | 7     | 90     |\n| 1  | 8     | 90     |\n+----+-------+--------+\n<strong>Output:</strong> \n+----+-------+--------+\n| id | month | Salary |\n+----+-------+--------+\n| 1  | 7     | 90     |\n| 1  | 4     | 130    |\n| 1  | 3     | 90     |\n| 1  | 2     | 50     |\n| 1  | 1     | 20     |\n| 2  | 1     | 20     |\n| 3  | 3     | 100    |\n| 3  | 2     | 40     |\n+----+-------+--------+\n<strong>Explanation:</strong> \nEmployee '1' has five salary records excluding their most recent month '8':\n- 90 for month '7'.\n- 60 for month '4'.\n- 40 for month '3'.\n- 30 for month '2'.\n- 20 for month '1'.\nSo the cumulative salary summary for this employee is:\n+----+-------+--------+\n| id | month | salary |\n+----+-------+--------+\n| 1  | 7     | 90     |  (90 + 0 + 0)\n| 1  | 4     | 130    |  (60 + 40 + 30)\n| 1  | 3     | 90     |  (40 + 30 + 20)\n| 1  | 2     | 50     |  (30 + 20 + 0)\n| 1  | 1     | 20     |  (20 + 0 + 0)\n+----+-------+--------+\nNote that the 3-month sum for month '7' is 90 because they did not work during month '6' or month '5'.\n\nEmployee '2' only has one salary record (month '1') excluding their most recent month '2'.\n+----+-------+--------+\n| id | month | salary |\n+----+-------+--------+\n| 2  | 1     | 20     |  (20 + 0 + 0)\n+----+-------+--------+\n\nEmployee '3' has two salary records excluding their most recent month '4':\n- 60 for month '3'.\n- 40 for month '2'.\nSo the cumulative salary summary for this employee is:\n+----+-------+--------+\n| id | month | salary |\n+----+-------+--------+\n| 3  | 3     | 100    |  (60 + 40 + 0)\n| 3  | 2     | 40     |  (40 + 0 + 0)\n+----+-------+--------+\n</pre>\n", "relatedTopics": [], "similarQuestions": [], "problemName": "find-cumulative-salary-of-an-employee"}